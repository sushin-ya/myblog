---
title: サイボウズの新人研修資料を読むその３
date: "2021-08-14T20:06:37.121Z"
---

こんにちは。今回で最後になります。

#### モブに早く慣れたい人のためのガイド

みんなで一つの画面を見ながら開発する手法をモブ・プログラミングっていうらしいです。おもしろいね

##### モブ・プログラミングの目的

- 高品質な成果物の生成
  - 強力なレビュー効果、チームの多様性
- チームメンバのレベル向上
  - 強力なグループ学習効果
    - ドメイン情報、知識、スキル

アプリケーションのドメイン知識が共有できてかなりわかるようになるらしい。会議で議事メモを書く効果に近いかもね

ひとりで知識を詰める時間も必要とのこと。当たり前だけど、そうですね。

#### 正規表現

一度はちゃんとした本で勉強したい。bash 芸でゴリゴリ抽出とかできると楽でいいよね。

##### 正規表現の利用例

- バリデーション
- 抽出

##### 基本的な正規表現

- `.`：任意の１文字
- `¥`：次のお t 区別文字をそのまま使う
- `[ab]`：[]の中の１文字をマッチする
- `[^ab]`：否定文字。含まれなかったらマッチ
- `[a-z]`：a から z の文字

##### 特別クラス

- `¥d`：数字＝[0-9]
- `¥D`：非数字＝[^0-9]
- `¥w`：文字（数字含む）＝[a-zA-z0-9_]
- `¥W`：非文字＝[^a-za-z0-9_]

##### 繰り返し

- `?`：0-1 回繰り返しマッチする
- `+`：1 回以上繰り返しマッチする
- `*`：0 回以上繰り返しマッチする
- `{min, max}`：min 回以上、max 回以下

##### 先頭と末尾

- `^`：行の先頭にマッチ
- `$`：行の末尾にマッチ

##### 後方参照

- `¥1`、`¥2`、`¥n`：n バネの()内のマッチしたものと同じ

ex) `<(div|p)>.\*<¥/¥1>`

```html
<div>hoge</div>
<p>hoge</p>
```

##### 後方参照２

- `(?:hoge)`：マッチはするが、¥1 には入らない
- `(?<name>hoge)(?P=name)`：名前付き後方参照グループ

#### Kubernetes を使った開発入門

知らない単語が盛りだくさん。こういうのがあるんだ程度で読んどきます。

##### なぜ Kubernetes を使うのか？

> Kubernetes は、データセンターのサーバー群を抽象化するレイヤーを提供します。 このレイヤーにより、OS がハードウェアとソフトウェアを疎結合にしたように、Kubernetes はアプリケーションとサーバーを疎結合にし、独立して開発・運用ができるようにしてくれます。

##### Pod

> Kubernetes にデプロイできる最小単位は Pod と呼ばれるリソースです。 Pod はひとつ以上のコンテナをまとめたものです。 同じ Pod に属するコンテナは常に同じノードに配置されます。 また、同じ Pod に属するコンテナはホスト名や IP アドレスを共有します。

プロセス＝ Conteiner、仮想マシン=Pod、実機=Node という読み替えができるらしい。

##### Service

Pod 間は IP をつかっても通信できるが、Service というリソースを使うことで、特定のラベルを持つ Pod へアクセス可能になる

##### ReplicaSet

冗長性やスケーラビリティのために同じサービスを複数立ち上げる必要があることがありますが、ReplicaSet というリソースを利用すれば指定した台数だけ立ち上げができるらしい

##### ローリングアップデート

アプリケーションの無停止更新の実現手段としてローリングアップデートがある。複数台同じアプリを立ち上げて、一台だけ更新する、というのをローテーションする方法。Kubernetes では Deployment というリソースで実現可能。

##### サービスをクラスタ外部に公開する

NodePort という方法があるらしい。ノードの指定したポート経由でサービスにアクセスできる。

##### ヘルスチェック

Kubernetes のヘルスチェックは２種類ある。

- Liveness probe：Pod の生死チェック。一定回数で再起動
- Readiness probe：Pod がリクエストに応答できるかチェック。成功しない場合、起動していないとみなされて Service のリバースプロキシ先に追加されない。

##### Resource Requests/Limits

> Resource Requests は、コンテナが要求するメモリや CPU の量を宣言する機能で、Kubernetes のスケジューラは Resource Requests の値を見て Pod をデプロイするノードを決めます。

何やらノードのリソースを割り当てる仕組みらしい

##### Volume

Pod に複数のコンテナがあって、ローカルディレクトリで共有したいときに使う機能。Docker 入門でも出てきた話ですね。

##### Anti Affinity

複数 Pod が同じノードにスケジュールされないようにする機能みたい。

##### Pod Disruption Budget

ノードの再起動時に、ローリングで再起動するとすべてのアプリが starting や rebooted で応答不能になってしまうことがある。それを防ぐために、最小の Pod 数を指定できる。

#### モニタリング入門

かなり詳しく書かれてるスライドなので、流し読み

##### モニタリングの用途

- 開発
  - 性能測定
  - デバッグ
  - 機能改善
- 運用
  - アラート
  - オートスケーリング
  - デプロイの自動化
- ビジネス
  - 利用状況の分析、意思決定のインプット

##### モニタリングの基本

- 収集：アプリやサーバからメトリクスを集める
- 蓄積：集めたメトリクスを保存
- 分析：保存したメトリクスから必要な情報を取り出す
- 可視化：取り出した情報を表示する
- アラート：取り出した情報に基づいて通知する

##### メトリクスの保存

いろいろあるらしい

- VictoriaMetrics
- Thanos
- Cortex
- M3DB

アプリや Kubernetes、Node などのメトリクスを収集して、モニタリングシステムで監視するんだって

##### メトリクスのタイプ

- Counter：増加する値
- Gauge：現在の値
- Summary：観測値の集計結果
- Histogram：観測値の集計データ

##### 時系列データのモデル

時系列データのキーとバリューで表される

```bash
metrics_name{key="value",...} → [(t1,v1), (t2, v2), ...]
```

##### PromQL

時系列データを取得・集計するためのクエリ言語

そういう分野もあるんですねって感じでした。

#### gRPC 入門

マイクロサービスの採用が進むと、様々なプログラミング言語間でのやり取りが発生するが、その通信プロトコルとして考えられたのが gRPC らしい。IDL にコンパイラが付属しているので、対応する言語に吐き出してくれる。

REST や GraphQL とは違って、公式でいろいろ機能が提供されているから便利。

仕様が小さいので学習コストが小さいが、HTTP/1 とは互換性がないのが注意。

#### 最後に

あまり詳しく立ち入らず、インデックスを貼る作業だと思ってざっと読んでみました。やっぱりインフラ周りの Docker や Kubernetes などは知らない概念がたくさんあって、そのうち勉強しないと行けないなと思いました。特に Docker は使えたら開発としても楽そうなので。。。
